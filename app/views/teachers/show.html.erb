<div class="container">
  <div class="row text-center">
    <div class="col-xs-12 text-center">
      <h1>Profil de <%= @teacher.name %></h1>
    </div>
    <div class="col-xs-12 col-sm-4 row">
      <div class="teacher text-center">
        <%= image_tag @teacher.picture.url(:medium) %>
        <h3><%= @teacher.name %></h3>
        <p><%= @teacher.email%></p>
      </div>
    </div>
    <div class="col-xs-12 col-sm-8 text-center">
      <h3>Mes lessons</h3>
      mettres le tableau des leçons
    </div>
    <div class="col-xs-12 text-center">
      <h3> Ses disponibilités </h3>
    </div>
  </div>
  <div class="row text-center">
    <div class="calendar col-xs-12 text-center teachercalendar" >
      <%= week_calendar do |date| %>
      <div class="day text-center" style= "padding-top: 5px; height: 30px;">
        <%= date.mday %>
      </div>
        <% (6..23).each do |hour| %>
          <% lesson = Lesson.new(starts_at: date + hour.hours, ends_at: date + hour.hours + 3600) %>
          <% availability = lesson.find_availability_for_teacher(params[:id]) %>
          <div class="day" style="height: 30px;">
            <%= form_for([@teacher, lesson]) do |f| %>
              <%= f.hidden_field :starts_at %>
              <%= f.hidden_field :ends_at %>
              <%= f.hidden_field :availability_id %>
                <% if availability.nil? && (date + hour.hours < Time.now) %>
                  <% teacher_path(params[:id]) %>
                <% elsif availability.nil? && (date + hour.hours >= Time.now) %>
                  <p style="color: #868686;"> <%= hour %>h - <%= hour + 1 %>h </p>
                  <% teacher_path(params[:id]) %>
                <% elsif availability.lesson_booked?(lesson.starts_at, lesson.ends_at) == false && date + hour.hours > Time.now %>
                  <%= f.submit "#{hour}h - #{hour + 1} h", :class => 'btn btn-link' %>
                <% elsif availability.lesson_booked?(lesson.starts_at, lesson.ends_at) && (date + hour.hours >= Time.now)  %>
                    <p> Booked </p>
                <% end %>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>


<br></br>
<br>
<%= link_to "sign out", destroy_teacher_session_path, method: :delete, :class => "btn btn-primary" %>
<%= link_to "Ajouter une disponibilité", teacher_add_availability_path(@teacher) %>